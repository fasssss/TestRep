@model PollesViewModel
@{
	IList<QuestionModel> questionsList = new List<QuestionModel> { new QuestionModel() };
}
<h1>Create or change existing poll</h1>
@if (Model.CurrentQuestions?.Count > 0)
{
		<form method="post" asp-controller="Home" asp-action="PollSaveChanges" asp-route-pollId="@Model.PollId" enctype="multipart/form-data">
			<ol>
				@for (int i = 0; i < Model.CurrentQuestions.Count; i++)
				{
					<li class="border border-dark m-1 p-1" style="background-color:aliceblue; border-radius: 0.5em">
						<div class="btn-group-vertical m-2 p-2">
							<input hidden="hidden" name="questionsId" value="@Model.CurrentQuestions[i].Id">
							<textarea class="form-control" style="border-radius: 0.5em" cols="150" rows="10" name="questionsText" value="@Model.CurrentQuestions[i].Question">@Model.CurrentQuestions[i].Question</textarea>
							<br>
							<input class="@i" type="file" name="uploadedFiles" />
							<input class="@i" hidden="hidden" type="number" name="questionIdForFiles" value="@Model.CurrentQuestions[i].Id" />
							<br>
							<a class="text-danger">Warning! Save changes before you leave eather you will lose your changes</a>
						</div>
					</li>
				}
			</ol>
			<button class="btn btn-primary float-right" onclick="filesSubmit()" style="border-radius: 0.5em" type="submit" name="action" value="change">Submit</button>
		</form>
		}
		<br>
		<br>
		<form method="post" asp-controller="Home" asp-action="PollSaveChanges" asp-route-pollId="@Model.PollId">
			<div style="text-align: center">
				<textarea class="form-control" style="border-radius: 0.5em" cols="120" rows="10" name="questionsText"></textarea>
			</div>
			<div style="text-align: center">
				<button class="btn btn-primary mt-1" style="border-radius: 0.5em" name="action" value="add">Add new question</button>
			</div>
		</form>
		
		<script type="text/javascript">
			function filesSubmit() {
				for (let i = 0; i < @Model.CurrentQuestions.Count; i++)
				{
					if (document.getElementsByClassName(i.toString())[0].files.length == 0) {
						document.getElementsByClassName(i.toString())[1].remove();
					}
				}
			}
		</script>

